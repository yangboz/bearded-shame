<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="interpretCstList" language="groovy" pageWidth="595" pageHeight="842" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20">
	<property name="ireport.zoom" value="1.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="V_BEGINDATE" class="java.lang.String"/>
	<parameter name="V_ENDDATE" class="java.lang.String"/>
	<queryString>
		<![CDATA[select shortname,profit,rownum from (
select cus.shortname,format_num((sum(twp.deviceincome)+sum(twp.income))-(sum(twp.deviceexpense)+sum(twp.expenditure))) as profit
from crm_customer cus
right join crm_contract act on cus.id=act.customer_id
right join tp_interpret_project twp on act.id=twp.contractid
where twp.status=1029 and twp.delflag=0 and twp.endDate>to_date($P{V_BEGINDATE} || ' 00:00:00','yyyy-mm-dd hh24:mi:ss')
        and twp.endDate<to_date($P{V_ENDDATE} || ' 23:59:59','yyyy-mm-dd hh24:mi:ss')
group by cus.shortname order by ((sum(twp.deviceincome)+sum(twp.income))-(sum(twp.deviceexpense)+sum(twp.expenditure))) desc)]]>
	</queryString>
	<field name="SHORTNAME" class="java.lang.String"/>
	<field name="PROFIT" class="java.lang.String"/>
	<field name="rownum" class="java.lang.String"/>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="40">
			<staticText>
				<reportElement x="48" y="0" width="459" height="20"/>
				<textElement>
					<font size="12"/>
				</textElement>
				<text><![CDATA[口译项目排行]]></text>
			</staticText>
			<staticText>
				<reportElement x="48" y="20" width="220" height="20"/>
				<box>
					<pen lineWidth="1.0"/>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.0"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="12"/>
				</textElement>
				<text><![CDATA[公司简称]]></text>
			</staticText>
			<staticText>
				<reportElement x="268" y="20" width="139" height="20"/>
				<box>
					<pen lineWidth="1.0"/>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.0"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="12"/>
				</textElement>
				<text><![CDATA[利润]]></text>
			</staticText>
			<staticText>
				<reportElement x="407" y="20" width="100" height="20"/>
				<box>
					<pen lineWidth="1.0"/>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.0"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="12"/>
				</textElement>
				<text><![CDATA[排名]]></text>
			</staticText>
		</band>
	</title>
	<detail>
		<band height="20" splitType="Stretch">
			<textField isStretchWithOverflow="true">
				<reportElement stretchType="RelativeToBandHeight" x="48" y="0" width="220" height="20"/>
				<box>
					<pen lineWidth="1.0"/>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.0"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font size="12"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[null==$F{SHORTNAME}?"":$F{SHORTNAME}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true">
				<reportElement stretchType="RelativeToBandHeight" x="268" y="0" width="139" height="20"/>
				<box>
					<pen lineWidth="1.0"/>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.0"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="12"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{PROFIT}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true">
				<reportElement stretchType="RelativeToBandHeight" x="407" y="0" width="100" height="20"/>
				<box>
					<pen lineWidth="1.0"/>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.0"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="12"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{rownum}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
</jasperReport>
